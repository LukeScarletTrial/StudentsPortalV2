<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Student Portal â€” Classroom UI</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
<style>
/* --- KEEP ALL UI STYLES INTACT --- */
:root{--bg:#f5f7fa;--surface:#fff;--muted:#6b7280;--primary:#1a73e8;--accent:#f59e0b;--danger:#e04848;--shadow:0 6px 18px rgba(19,24,31,0.06);--radius:12px;--maxWidth:1200px;--gap:16px;font-family:'Poppins',system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;}
*{box-sizing:border-box} body{margin:0;padding:24px;background:var(--bg);font-family:var(--font);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;justify-content:center;} 
.app{display:grid;grid-template-columns:260px 1fr;gap:var(--gap);width:100%;max-width:var(--maxWidth);align-items:start;}
.sidebar{background:var(--surface);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);position:sticky;top:24px;height:calc(100vh - 48px);overflow:auto;}
.brand{display:flex;gap:12px;align-items:center;margin-bottom:14px}
.logo{width:44px;height:44px;background:linear-gradient(135deg,var(--primary),#6b8af6);border-radius:10px;color:white;font-weight:700;font-size:18px;display:flex;align-items:center;justify-content:center;}
.brand .title{font-weight:600;font-size:16px;}
.brand .sub{font-size:12px;color:var(--muted);}
.sidebar-nav{display:flex;flex-direction:column;gap:8px;margin-top:8px;}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;font-weight:500;color:#0f172a;cursor:pointer;}
.nav-item:hover{background:#f3f6ff}
.nav-item.active{background:linear-gradient(90deg, rgba(26,115,232,0.08), rgba(26,115,232,0.04));border-left:4px solid var(--primary);padding-left:8px;}
.icon{font-variation-settings:'FILL' 0,'wght' 400,'GRAD' 0,'opsz' 24;font-size:20px;color:var(--primary);}
.profile-card{margin-top:16px;padding:12px;border-radius:10px;background:linear-gradient(90deg,#f8fafc,#fff);border:1px solid #eef2ff;}
.profile-name{font-weight:600;}
.profile-role{font-size:12px;color:var(--muted);}
.sidebar button{width:100%;}
.main{display:flex;flex-direction:column;gap:var(--gap);}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:8px 0;}
.search{display:flex;align-items:center;gap:8px;background:var(--surface);border-radius:12px;padding:8px 10px;box-shadow:var(--shadow);min-width:420px;max-width:640px;}
.search input{border:0;outline:0;background:transparent;width:100%;font-size:14px;}
.top-actions{display:flex;gap:10px;align-items:center;}
.card{background:var(--surface);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;}
.section-title{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
.list-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;border:1px solid #f1f5f9;margin-bottom:8px;background:#fff;}
.chat-area{display:flex;flex-direction:column;gap:12px;}
.chat-window{height:300px;border-radius:10px;border:1px solid #eef2ff;padding:12px;overflow:auto;background:#f8fbff;}
.message{padding:10px;border-radius:8px;background:#eef6ff;margin-bottom:8px;}
.message .meta{font-size:12px;color:var(--muted);margin-bottom:6px;}
.chat-input{display:flex;gap:10px;align-items:center;}
.chat-input input{flex:1;padding:12px;border-radius:10px;border:1px solid #eef2ff;background:#ffffff;}
.btn{padding:10px 12px;border-radius:10px;border:0;background:var(--primary);color:white;cursor:pointer;font-weight:600;}
.btn.ghost{background:transparent;border:1px solid #e6eefc;color:var(--primary);}
.btn.danger{background:var(--danger);}
#authModal{display:none;position:fixed;inset:0;background:rgba(15,23,42,0.45);align-items:center;justify-content:center;z-index:1000;}
#authModal>div{background:var(--surface);padding:22px;border-radius:12px;max-width:520px;width:100%;box-shadow:var(--shadow);}
@media(max-width:980px){.app{grid-template-columns:1fr;padding-bottom:160px}.sidebar{position:relative;height:auto}.search{min-width:unset;width:100%}.chat-window{height:200px}}

/* Additional styles for improved UI */
.toast {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 12px 20px;
  border-radius: 8px;
  background: var(--surface);
  box-shadow: var(--shadow);
  z-index: 1001;
  transform: translateX(150%);
  transition: transform 0.3s ease;
}
.toast.show {
  transform: translateX(0);
}
.toast.success {
  border-left: 4px solid #10b981;
}
.toast.error {
  border-left: 4px solid var(--danger);
}
.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255,255,255,.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
}
@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="brand"><div class="logo">SP</div><div><div class="title">Student Portal</div><div class="sub">Classroom UI</div></div></div>
    <nav class="sidebar-nav">
      <div class="nav-item active" data-tab="dashboard"><span class="material-symbols-outlined icon">home</span>Dashboard</div>
      <div class="nav-item" data-tab="projects"><span class="material-symbols-outlined icon">work</span>Projects</div>
      <div class="nav-item" data-tab="assignments"><span class="material-symbols-outlined icon">assignment</span>Assignments</div>
      <div class="nav-item" data-tab="events"><span class="material-symbols-outlined icon">event</span>Events</div>
      <div class="nav-item" data-tab="conversations"><span class="material-symbols-outlined icon">chat_bubble</span>Conversations</div>
      <div class="nav-item" data-tab="clubs"><span class="material-symbols-outlined icon">account_balance</span>Clubs</div>
      <div class="nav-item" data-tab="reports"><span class="material-symbols-outlined icon">report</span>Reports</div>
      <div class="nav-item" data-tab="profile"><span class="material-symbols-outlined icon">person</span>Profile</div>
      <div id="adminNav" class="nav-item" data-tab="admin" style="display:none"><span class="material-symbols-outlined icon">admin_panel_settings</span>Admin Panel</div>
    </nav>
    <div class="profile-card"><div class="profile-name" id="sideName">Guest</div><div class="profile-role" id="sideRole">Not signed in</div></div>
    <div style="margin-top:12px;display:flex;gap:8px">
      <button id="sidebarLogout" class="btn ghost" style="flex:1; display:none">Logout</button>
      <button id="openLogin" class="btn" style="flex:1">Login</button>
    </div>
  </aside>

  <!-- Main content -->
  <main class="main">
    <div class="topbar">
      <div class="search"><span class="material-symbols-outlined" style="color:var(--muted)">search</span><input id="globalSearch" placeholder="Search projects, groups, assignments..."></div>
      <div class="top-actions"><div style="text-align:right"><div id="welcomeText" style="font-weight:600">Welcome</div><div class="small-muted" id="welcomeSub">Please sign in</div></div></div>
    </div>

    <!-- Sections -->
    <section id="dashboard" class="card"><h3>Dashboard</h3><p>Welcome to your student dashboard. Select a section from the sidebar to get started.</p></section>
    <section id="projects" class="card" style="display:none"><h3>Projects</h3><div id="projectsList"></div></section>
    <section id="assignments" class="card" style="display:none"><h3>Assignments</h3><div id="assignmentsList"></div></section>
    <section id="events" class="card" style="display:none"><h3>Events</h3><div id="eventsList"></div></section>
    <section id="conversations" class="card" style="display:none"><h3>Conversations</h3><div class="chat-area"><select id="convList"></select><div class="chat-window" id="chatWindow"></div><div class="chat-input"><input id="chatInput"><button class="btn" id="sendBtn">Send</button></div></div></section>
    <section id="clubs" class="card" style="display:none"><h3>Clubs</h3><div id="clubsList"></div></section>
    <section id="reports" class="card" style="display:none"><h3>Reports</h3><div id="reportsList"></div></section>
    <section id="profile" class="card" style="display:none"><h3>Profile</h3></section>
    <section id="admin" class="card" style="display:none"><h3>Admin</h3></section>
  </main>
</div>

<!-- Auth Modal -->
<div id="authModal"><div>
  <h3>Sign in / Register</h3>
  <input id="modalEmail" placeholder="Email" style="width:100%;padding:8px;margin:4px 0">
  <input id="modalPass" type="password" placeholder="Password" style="width:100%;padding:8px;margin:4px 0">
  <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
    <button id="modalRegister" class="btn ghost">Register</button>
    <button id="modalLogin" class="btn">Login</button>
  </div>
</div></div>

<!-- Toast notification -->
<div id="toast" class="toast"></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>

<script>
// --- Firebase config ---
const firebaseConfig = {
  apiKey: "AIzaSyApBvfatNOG71P8SUB_uYT08zGeOmC8VlY",
  authDomain: "student-portal-61ead.firebaseapp.com",
  projectId: "student-portal-61ead",
  storageBucket: "student-portal-61ead.firebasestorage.app",
  messagingSenderId: "415484265376",
  appId: "1:415484265376:web:41d53b79ac5059a0a35ac5",
  measurementId: "G-JHCC3HQ20M"
};

// --- Initialize Firebase ---
firebase.initializeApp(firebaseConfig);
const analytics = firebase.analytics();
const auth = firebase.auth();
const db = firebase.firestore();

// --- UI Functions ---
function showToast(message, type = 'success') {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.className = `toast ${type}`;
  toast.classList.add('show');
  
  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
}

function setLoading(button, isLoading) {
  if (isLoading) {
    button.disabled = true;
    button.innerHTML = '<span class="loading"></span>';
  } else {
    button.disabled = false;
    button.innerHTML = button.getAttribute('data-original-text');
  }
}

// --- Sidebar navigation ---
const navItems = document.querySelectorAll(".nav-item");
navItems.forEach(item => {
  item.addEventListener("click", () => {
    document.querySelectorAll("section").forEach(sec => sec.style.display = "none");
    const tab = item.dataset.tab;
    document.getElementById(tab).style.display = "block";
    navItems.forEach(i => i.classList.remove("active"));
    item.classList.add("active");
  });
});

// --- Modal toggle ---
const authModal = document.getElementById("authModal");
const openLoginBtn = document.getElementById("openLogin");
openLoginBtn.addEventListener("click", () => authModal.style.display = "flex");
authModal.addEventListener("click", e => { 
  if(e.target === authModal) authModal.style.display = "none"; 
});

// --- Auth buttons ---
document.getElementById("modalRegister").addEventListener("click", () => {
  const email = document.getElementById("modalEmail").value;
  const pass = document.getElementById("modalPass").value;
  const button = document.getElementById("modalRegister");
  
  if (!email || !pass) {
    showToast('Please enter both email and password', 'error');
    return;
  }
  
  // Store original text and set loading state
  button.setAttribute('data-original-text', button.textContent);
  setLoading(button, true);
  
  auth.createUserWithEmailAndPassword(email, pass)
    .then(u => { 
      showToast("Registered successfully!");
      authModal.style.display="none"; 
    })
    .catch(err => {
      showToast(err.message, 'error');
    })
    .finally(() => {
      setLoading(button, false);
    });
});

document.getElementById("modalLogin").addEventListener("click", () => {
  const email = document.getElementById("modalEmail").value;
  const pass = document.getElementById("modalPass").value;
  const button = document.getElementById("modalLogin");
  
  if (!email || !pass) {
    showToast('Please enter both email and password', 'error');
    return;
  }
  
  // Store original text and set loading state
  button.setAttribute('data-original-text', button.textContent);
  setLoading(button, true);
  
  auth.signInWithEmailAndPassword(email, pass)
    .then(u => { 
      showToast("Logged in successfully!");
      authModal.style.display="none"; 
    })
    .catch(err => {
      showToast(err.message, 'error');
    })
    .finally(() => {
      setLoading(button, false);
    });
});

document.getElementById("sidebarLogout").addEventListener("click", () => {
  auth.signOut().then(() => showToast("Logged out successfully!"));
});

// --- Auth state listener ---
auth.onAuthStateChanged(user => {
  const sideName = document.getElementById("sideName");
  const sideRole = document.getElementById("sideRole");
  const welcomeText = document.getElementById("welcomeText");
  const welcomeSub = document.getElementById("welcomeSub");
  const loginBtn = document.getElementById("openLogin");
  const logoutBtn = document.getElementById("sidebarLogout");

  if(user){
    sideName.textContent = user.email;
    sideRole.textContent = "Student";
    welcomeText.textContent = `Welcome, ${user.email}`;
    welcomeSub.textContent = "Ready to learn!";
    loginBtn.style.display = "none";
    logoutBtn.style.display = "block";
  } else {
    sideName.textContent = "Guest";
    sideRole.textContent = "Not signed in";
    welcomeText.textContent = "Welcome";
    welcomeSub.textContent = "Please sign in";
    loginBtn.style.display = "block";
    logoutBtn.style.display = "none";
  }
});

// --- Firestore real-time updates ---
const projectsList = document.getElementById("projectsList");
db.collection("projects").onSnapshot(snapshot => {
  projectsList.innerHTML = "";
  
  if (snapshot.empty) {
    projectsList.innerHTML = "<div class='list-item'>No projects yet</div>";
    return;
  }
  
  snapshot.forEach(doc => {
    const div = document.createElement("div");
    div.className = "list-item";
    div.textContent = doc.data().name || "Unnamed project";
    projectsList.appendChild(div);
  });
});

// --- Placeholder for other sections (assignments, events, etc.) ---
const placeholders = ["assignmentsList","eventsList","clubsList","reportsList"];
placeholders.forEach(id => {
  const container = document.getElementById(id);
  if(container) container.innerHTML = "<div class='list-item'>No data yet</div>";
});
</script>
</body>
</html>
